/**
 * Created by mohit on 9/10/15.
 */
var Promise = require("bluebird");

module.exports  = function(redisClient){
    var regionCodes = ["BHNG","BIJ","SANR","DMPI","RAJA","KHED","BHIL","DARJ","TIRU","SHVG","YAVA","HSBD","ALSR","BHRT","IDAR","AURA","GDHAM","AGRA","GUNA","ABDB","VIZI","CUDD","RAJK","JAMM","MAND","BHAT","DMSL","PUNE","MANA","MVLR","KVLI","KOCH","AMAP","HALD","COIM","SAGA","BARA","WARD","TTCN","SANA","RWAA","KOTA","REWA","ARIY","RENU","WAR","RNG","MLR","DURGA","TMB","GUDR","KNPM","MGSI","DAVA","CHIN","BILA","HUBL","RANA","LNVL","TRIC","GUW","PARA","SEON","PUDH","MIHP","BEED","NAGP","JORT","BAR","RUPN","RKES","SRKL","ABOR","ERNK","PNCH","NADI","THAL","HOSH","KANN","CHDM","KTYM","NAND","BARE","GOA","GDVK","LUDH","TIRV","COOR","ALI","BOIS","TIRP","MOGA","AHMED","HWRH","NEEM","AMAN","MHAD","SOLA","PEDA","VERU","TAJO","TENA","HYD","SATH","PURN","SEHO","GULB","SANG","MORA","KUND","VAD","TRIV","KURN","DHUL","KARN","DEWAS","AKOL","GHAR","EROD","BLPR","JHAJ","BEHA","AND","KCHA","CHAM","KNGN","FARI","MUZ","VAR","DAMA","RAI","MANI","ZAGE","DIB","DAUS","ABRD","MRGD","HOOG","KURU","TINS","PANC","KOTK","CHD","ALWR","UDAI","DIND","GAYA","AJMER","MAHB","JAM","NIZA","KANG","KOLM","KATH","KHAM","BIK","MATH","SCBD","ADPR","ANHL","MUMBAI","NCR","BETU","KTCH","KHOP","DMPR","TAWA","PATN","JPG","BHWD","ARUP","RAIH","KHDW","MNSA","ANGA","VAPI","SALM","GNAGAR","HAJI","GWAL","MTPM","VIJA","JETP","JALA","THSR","KCKA","MKST","KHAN","TENK","UNKD","NARY","FRZR","GUNT","PATA","AMRA","PARB","UDUP","LEHA","KAKI","KWAR","COBE","KISH","KULU","SILI","SCO","DEH","HIMM","BHOP","PAN","NMCH","BHIW","JAIP","PATR","RSRA","JSMR","DHAR","KALY","DHMT","MADU","SURY","SIL","VLSD","KOLK","BAL","VELL","PHAL","KUMB","PRVT","SKRP","ZIRO","HUZU","SURT","SHIV","SARN","IND","KANP","ROH","SAMP","KTGM","99","KARG","SIKR","RAIPUR","PALG","MDAK","ROOR","VIZA","ASANSOL","NVSR","TNO","SDDP","MORI","KRBA","SILV","BANS","JADC","MANG","JABL","SHLG","RJMU","BOKA","RAIG","MARR","BURD","PURI","RAMN","HAMI","PARI","BULD","DURG","SAMB","HRDR","KARIM","SAHA","SRIG","NATH","PIMP","BHILAI","BHUB","UDGR","SIV","ANAN","SATA","RAMP","VKBD","BHAR","RATL","MSS","POCH","AHD","JAGD","JALG","NASK","KAIT","MALE","SING","YRLL","TUMK","DHAN","AMB","ANKL","AGAR","PEN","JODH","SPAN","GRKP","LAVA","CHEN","DBBK","PALN","KAWA","KATR","THRM","VIET","BADD","BELG","BANG","DHLE","SMLA","MARC","NAVN","PATI","IDKI","LAT","JANG","RUDP","TAND","BAIJ","KUSH","ZIRK","PLWA","JNSI","LUCK","UJJN","BNGA","NAIN","OOTY","AMRI","MOHL","SISA","HRDA","ALBG","BLGT","INDA","PATH","POND","DHRA","JIND","BLSR","MART","KOLH","MNGU","DOGH","KADI","RANC","ADIL","CHAN","BIDR","YAMU","AHMG","BICH","ALLH","JUGH","BEAW","HISR","MYS","JMDP","MERT"]
    var regionWithDetails  = {"BHNG": {"name":"Bhavnagar","state":"Gujarat"},"BIJ": {"name":"Bijnor","state":"Uttar Pradesh"},"SANR": {"name":"Sangrur","state":"Punjab"},"DMPI": {"name":"Dharmapuri","state":"Tamil Nadu"},"RAJA": {"name":"Rajnandgaon","state":"Chhattisgarh"},"KHED": {"name":"Khed","state":"Maharashtra"},"BHIL": {"name":"Bhilwara","state":"Rajasthan"},"DARJ": {"name":"Darjeeling","state":"West Bengal"},"TIRU": {"name":"Tirupati","state":"Andhra Pradesh"},"SHVG": {"name":"Sivagangai","state":"Tamil Nadu"},"YAVA": {"name":"Yavatmal","state":"Maharashtra"},"HSBD": {"name":"Husnabad","state":"Telangana"},"ALSR": {"name":"Alsisar (Rajasthan)","state":"Rajasthan"},"BHRT": {"name":"Bharatpur","state":"Rajasthan"},"IDAR": {"name":"Idar","state":"Gujarat"},"AURA": {"name":"Aurangabad","state":"Maharashtra"},"GDHAM": {"name":"Gandhidham","state":"Gujarat"},"AGRA": {"name":"Agra","state":"Uttar Pradesh"},"GUNA": {"name":"Guna","state":"Madhya Pradesh"},"ABDB": {"name":"Abu Dhabi","state":"UAE"},"VIZI": {"name":"Vizianagaram","state":"Andhra Pradesh"},"CUDD": {"name":"Cuddalore","state":"Tamil Nadu"},"RAJK": {"name":"Rajkot","state":"Gujarat"},"JAMM": {"name":"Jammu","state":"Jammu and Kashmir"},"MAND": {"name":"Mandapeta","state":"Andhra Pradesh"},"BHAT": {"name":"Bathinda","state":"Punjab"},"DMSL": {"name":"Dharamsala","state":"Himachal Pradesh"},"PUNE": {"name":"Pune","state":"Maharashtra"},"MANA": {"name":"Manali","state":"Himachal Pradesh"},"MVLR": {"name":"Mavellikara","state":"Kerala"},"KVLI": {"name":"Kavali","state":"Andhra Pradesh"},"KOCH": {"name":"Kochi","state":"Kerala"},"AMAP": {"name":"Amalapuram","state":"Andhra Pradesh"},"HALD": {"name":"Haldia","state":"West Bengal"},"COIM": {"name":"Coimbatore","state":"Tamil Nadu"},"SAGA": {"name":"Sagwara","state":"Rajasthan"},"BARA": {"name":"Baramati","state":"Maharashtra"},"WARD": {"name":"Wardha","state":"Maharashtra"},"TTCN": {"name":"Tuticorin","state":"Tamil Nadu"},"SANA": {"name":"Sanand","state":"Gujarat"},"RWAA": {"name":"Rewa","state":"Madhya Pradesh"},"KOTA": {"name":"Kota","state":"Rajasthan"},"REWA": {"name":"Rewari","state":"Haryana"},"ARIY": {"name":"Ariyalur","state":"Tamil Nadu"},"RENU": {"name":"Renukoot","state":"Uttar Pradesh"},"WAR": {"name":"Warangal","state":"Telangana"},"RNG": {"name":"Rongjeng","state":"Meghalaya"},"MLR": {"name":"Mangalore","state":"Karnataka"},"DURGA": {"name":"Durgapur","state":"West Bengal"},"TMB": {"name":"Tembhode","state":"Maharashtra"},"GUDR": {"name":"Gudur","state":"Andhra Pradesh"},"KNPM": {"name":"Kanchipuram","state":"Tamil Nadu"},"MGSI": {"name":"Mughalsarai","state":"Uttar Pradesh"},"DAVA": {"name":"Davangere","state":"Karnataka"},"CHIN": {"name":"Chhindwara","state":"Madhya Pradesh"},"BILA": {"name":"Bilaspur","state":"Chhattisgarh"},"HUBL": {"name":"Hubli","state":"Karnataka"},"RANA": {"name":"Ranaghat","state":"West Bengal"},"LNVL": {"name":"Lonavala","state":"Maharashtra"},"TRIC": {"name":"Trichy","state":"Tamil Nadu"},"GUW": {"name":"Guwahati","state":"Assam"},"PARA": {"name":"Paratwada","state":"Maharashtra"},"SEON": {"name":"Seoni","state":"Madhya Pradesh"},"PUDH": {"name":"Pudhukottai","state":"Tamil Nadu"},"MIHP": {"name":"Mandi","state":"Himachal Pradesh"},"BEED": {"name":"Beed","state":"Maharashtra"},"NAGP": {"name":"Nagpur","state":"Maharashtra"},"JORT": {"name":"Jorhat","state":"Assam"},"BAR": {"name":"Barnala","state":"Punjab"},"RUPN": {"name":"Rupnagar","state":"Punjab"},"RKES": {"name":"Rishikesh","state":"Uttarakhand"},"SRKL": {"name":"Srikakulam","state":"Andhra Pradesh"},"ABOR": {"name":"Abohar","state":"Punjab"},"ERNK": {"name":"Ernakulam","state":"Kerala"},"PNCH": {"name":"Panchkula","state":"Haryana"},"NADI": {"name":"Nadiad","state":"Gujarat"},"THAL": {"name":"Thalayolaparambu","state":"Kerala"},"HOSH": {"name":"Hoshiarpur","state":"Punjab"},"KANN": {"name":"Kannur","state":"Kerala"},"CHDM": {"name":"Chinnamandem","state":"Andhra Pradesh"},"KTYM": {"name":"Kottayam","state":"Kerala"},"NAND": {"name":"Nanded","state":"Maharashtra"},"BARE": {"name":"Bareilly","state":"Uttar Pradesh"},"GOA": {"name":"Goa","state":"Goa"},"GDVK": {"name":"Godavarikhani","state":"Telangana"},"LUDH": {"name":"Ludhiana","state":"Punjab"},"TIRV": {"name":"Tirunelveli","state":"Tamil Nadu"},"COOR": {"name":"Coorg","state":"Karnataka"},"ALI": {"name":"Aligarh","state":"Uttar Pradesh"},"BOIS": {"name":"Boisar","state":"Maharashtra"},"TIRP": {"name":"Tirupur","state":"Tamil Nadu"},"MOGA": {"name":"Moga","state":"Punjab"},"AHMED": {"name":"Ahmednagar","state":"Maharashtra"},"HWRH": {"name":"Howrah","state":"West Bengal"},"NEEM": {"name":"Neemrana","state":"Rajasthan"},"AMAN": {"name":"Amangal","state":"Telangana"},"MHAD": {"name":"Mahad","state":"Maharashtra"},"SOLA": {"name":"Solapur","state":"Maharashtra"},"PEDA": {"name":"Peddapalli","state":"Telangana"},"VERU": {"name":"Vemulawada","state":"Telangana"},"TAJO": {"name":"Tanjore","state":"Tamil Nadu"},"TENA": {"name":"Tenali","state":"Andhra Pradesh"},"HYD": {"name":"Hyderabad","state":"Telangana"},"SATH": {"name":"Sathupally","state":"Telangana"},"PURN": {"name":"Purnea","state":"Bihar"},"SEHO": {"name":"Sehore","state":"Madhya Pradesh"},"GULB": {"name":"Gulbarga","state":"Karnataka"},"SANG": {"name":"Sangli","state":"Maharashtra"},"MORA": {"name":"Moradabad","state":"Uttar Pradesh"},"KUND": {"name":"Kundli","state":"Haryana"},"VAD": {"name":"Vadodara","state":"Gujarat"},"TRIV": {"name":"Trivandrum","state":"Kerala"},"KURN": {"name":"Kurnool","state":"Andhra Pradesh"},"DHUL": {"name":"Dhulia","state":"Maharashtra"},"KARN": {"name":"Karnal","state":"Haryana"},"DEWAS": {"name":"Dewas","state":"Madhya Pradesh"},"AKOL": {"name":"Akola","state":"Maharashtra"},"GHAR": {"name":"Ghazipur","state":"Uttar Pradesh"},"EROD": {"name":"Erode","state":"Tamil Nadu"},"BLPR": {"name":"Bolpur","state":"West Bengal"},"JHAJ": {"name":"Jhajjar","state":"Haryana"},"BEHA": {"name":"Berhampore","state":"West Bengal"},"AND": {"name":"Anand","state":"Gujarat"},"KCHA": {"name":"Kichha","state":"Uttarakhand"},"CHAM": {"name":"Champa","state":"Chhattisgarh"},"KNGN": {"name":"Kondagaon","state":"Chhattisgarh"},"FARI": {"name":"Faridabad","state":"Haryana"},"MUZ": {"name":"Muzaffarnagar","state":"Uttar Pradesh"},"VAR": {"name":"Varanasi","state":"Uttar Pradesh"},"DAMA": {"name":"Daman","state":"Gujarat"},"RAI": {"name":"Raigad","state":"Maharashtra"},"MANI": {"name":"Manipal","state":"Karnataka"},"ZAGE": {"name":"Zaheerabad","state":"Telangana"},"DIB": {"name":"Dibrugarh","state":"Assam"},"DAUS": {"name":"Dausa","state":"Rajasthan"},"ABRD": {"name":"Abu Road","state":"Rajasthan"},"MRGD": {"name":"Miryalaguda","state":"Telangana"},"HOOG": {"name":"Hooghly","state":"West Bengal"},"KURU": {"name":"Kurukshetra","state":"Haryana"},"TINS": {"name":"Tinsukia","state":"Assam"},"PANC": {"name":"Panchgani","state":"Maharashtra"},"KOTK": {"name":"Kotkapura","state":"Punjab"},"CHD": {"name":"Chandigarh","state":"Punjab"},"ALWR": {"name":"Alwar","state":"Rajasthan"},"UDAI": {"name":"Udaipur","state":"Rajasthan"},"DIND": {"name":"Dindigul","state":"Tamil Nadu"},"GAYA": {"name":"Gaya","state":"Bihar"},"AJMER": {"name":"Ajmer","state":"Rajasthan"},"MAHB": {"name":"Mahbubnagar","state":"Telangana"},"JAM": {"name":"Jamnagar","state":"Gujarat"},"NIZA": {"name":"Nizamabad","state":"Telangana"},"KANG": {"name":"Kangra","state":"Himachal Pradesh"},"KOLM": {"name":"Kollam","state":"Kerala"},"KATH": {"name":"Kathua","state":"Jammu and Kashmir"},"KHAM": {"name":"Khammam","state":"Telangana"},"BIK": {"name":"Bikaner","state":"Rajasthan"},"MATH": {"name":"Mathura","state":"Uttar Pradesh"},"SCBD": {"name":"Secunderabad","state":"Telangana"},"ADPR": {"name":"Adipur","state":"Gujarat"},"ANHL": {"name":"Anchal","state":"Kerala"},"MUMBAI": {"name":"Mumbai","state":"Maharashtra"},"NCR": {"name":"National Capital Region (NCR)","state":"NCR"},"BETU": {"name":"Betul","state":"Madhya Pradesh"},"KTCH": {"name":"Kutch","state":"Gujarat"},"KHOP": {"name":"Khopoli","state":"Maharashtra"},"DMPR": {"name":"Dimapur","state":"Nagaland"},"TAWA": {"name":"Tawang","state":"Arunachal Pradesh"},"PATN": {"name":"Patna","state":"Bihar"},"JPG": {"name":"Jalpaiguri","state":"West Bengal"},"BHWD": {"name":"Bhiwadi","state":"Rajasthan"},"ARUP": {"name":"Aruppukottai","state":"Tamil Nadu"},"RAIH": {"name":"Sonipat","state":"Haryana"},"KHDW": {"name":"Khandwa","state":"Madhya Pradesh"},"MNSA": {"name":"Mansa","state":"Punjab"},"ANGA": {"name":"Angamaly","state":"Kerala"},"VAPI": {"name":"Vapi","state":"Gujarat"},"SALM": {"name":"Salem","state":"Tamil Nadu"},"GNAGAR": {"name":"Gandhinagar","state":"Gujarat"},"HAJI": {"name":"Hajipur","state":"Bihar"},"GWAL": {"name":"Gwalior","state":"Madhya Pradesh"},"MTPM": {"name":"Mettuppalayam","state":"Tamil Nadu"},"VIJA": {"name":"Vijayawada","state":"Andhra Pradesh"},"JETP": {"name":"Jetpur","state":"Gujarat"},"JALA": {"name":"Jalandhar","state":"Punjab"},"THSR": {"name":"Thrissur","state":"Kerala"},"KCKA": {"name":"Korutla","state":"Telangana"},"MKST": {"name":"Muktsar","state":"Punjab"},"KHAN": {"name":"Khanna","state":"Punjab"},"TENK": {"name":"Tenkasi","state":"Tamil Nadu"},"UNKD": {"name":"United Kingdom","state":"United Kingdom"},"NARY": {"name":"Narayankhed","state":"Telangana"},"FRZR": {"name":"Firozpur","state":"Punjab"},"GUNT": {"name":"Guntur","state":"Andhra Pradesh"},"PATA": {"name":"Patan","state":"Gujarat"},"AMRA": {"name":"Amravati","state":"Maharashtra"},"PARB": {"name":"Parbhani","state":"Maharashtra"},"UDUP": {"name":"Udupi","state":"Karnataka"},"LEHA": {"name":"Ladakh","state":"Jammu and Kashmir"},"KAKI": {"name":"Kakinada","state":"Andhra Pradesh"},"KWAR": {"name":"Karwar","state":"Karnataka"},"COBE": {"name":"Cooch Behar","state":"West Bengal"},"KISH": {"name":"Kishangarh","state":"Rajasthan"},"KULU": {"name":"Kullu","state":"Himachal Pradesh"},"SILI": {"name":"Siliguri","state":"West Bengal"},"SCO": {"name":"Solan","state":"Himachal Pradesh"},"DEH": {"name":"Dehradun","state":"Uttarakhand"},"HIMM": {"name":"Himmatnagar","state":"Gujarat"},"BHOP": {"name":"Bhopal","state":"Madhya Pradesh"},"PAN": {"name":"Panipat","state":"Haryana"},"NMCH": {"name":"Neemuch","state":"Madhya Pradesh"},"BHIW": {"name":"Bhiwandi","state":"Maharashtra"},"JAIP": {"name":"Jaipur","state":"Rajasthan"},"PATR": {"name":"Patran","state":"Punjab"},"RSRA": {"name":"Rishra","state":"West Bengal"},"JSMR": {"name":"Jaisalmer","state":"Rajasthan"},"DHAR": {"name":"Dharapuram","state":"Tamil Nadu"},"KALY": {"name":"Kalyani","state":"West Bengal"},"DHMT": {"name":"Dhamtari","state":"Chhattisgarh"},"MADU": {"name":"Madurai","state":"Tamil Nadu"},"SURY": {"name":"Suryapet","state":"Telangana"},"SIL": {"name":"Silchar","state":"Assam"},"VLSD": {"name":"Valsad","state":"Gujarat"},"KOLK": {"name":"Kolkata","state":"West Bengal"},"BAL": {"name":"Baloda Bazar","state":"Chhattisgarh"},"VELL": {"name":"Vellore","state":"Tamil Nadu"},"PHAL": {"name":"Phaltan","state":"Maharashtra"},"KUMB": {"name":"Kumbakonam","state":"Tamil Nadu"},"PRVT": {"name":"Parvathipuram","state":"Andhra Pradesh"},"SKRP": {"name":"Shankarpally","state":"Telangana"},"ZIRO": {"name":"Ziro","state":"Arunachal Pradesh"},"HUZU": {"name":"Huzurabad","state":"Telangana"},"SURT": {"name":"Surat","state":"Gujarat"},"SHIV": {"name":"Shivpuri","state":"Madhya Pradesh"},"SARN": {"name":"Sarni","state":"Madhya Pradesh"},"IND": {"name":"Indore","state":"Madhya Pradesh"},"KANP": {"name":"Kanpur","state":"Uttar Pradesh"},"ROH": {"name":"Rohtak","state":"Haryana"},"SAMP": {"name":"Sagar","state":"Madhya Pradesh"},"KTGM": {"name":"Kothagudem","state":"Telangana"},"99": {"name":"Alappuzha","state":"Kerala"},"KARG": {"name":"Karunagapally","state":"Kerala"},"SIKR": {"name":"Sikar","state":"Rajasthan"},"RAIPUR": {"name":"Raipur","state":"Chhattisgarh"},"PALG": {"name":"Palghar","state":"Maharashtra"},"MDAK": {"name":"Medak","state":"Telangana"},"ROOR": {"name":"Roorkee","state":"Uttarakhand"},"VIZA": {"name":"Vizag","state":"Andhra Pradesh"},"ASANSOL": {"name":"Asansol","state":"West Bengal"},"NVSR": {"name":"Navsari","state":"Gujarat"},"TNO": {"name":"Tilda Neora","state":"Chhattisgarh"},"SDDP": {"name":"Siddipet","state":"Telangana"},"MORI": {"name":"Morinda","state":"Punjab"},"KRBA": {"name":"Korba","state":"Chhattisgarh"},"SILV": {"name":"Silvassa","state":"Gujarat"},"BANS": {"name":"Banswara","state":"Rajasthan"},"JADC": {"name":"Jadcherla","state":"Telangana"},"MANG": {"name":"Mangaldoi","state":"Assam"},"JABL": {"name":"Jabalpur","state":"Madhya Pradesh"},"SHLG": {"name":"Shillong","state":"Meghalaya"},"RJMU": {"name":"Rajahmundry","state":"Andhra Pradesh"},"BOKA": {"name":"Bokaro","state":"Jharkhand"},"RAIG": {"name":"Raigarh","state":"Chhattisgarh"},"MARR": {"name":"Marripeda","state":"Telangana"},"BURD": {"name":"Burdwan","state":"West Bengal"},"PURI": {"name":"Puri","state":"Orissa"},"RAMN": {"name":"Ramnagar","state":"Uttarakhand"},"HAMI": {"name":"Hamirpur (HP)","state":"Himachal Pradesh"},"PARI": {"name":"Parigi","state":"Telangana"},"BULD": {"name":"Buldana","state":"Maharashtra"},"DURG": {"name":"Durg","state":"Chhattisgarh"},"SAMB": {"name":"Sambalpur","state":"Orissa"},"HRDR": {"name":"Haridwar","state":"Uttarakhand"},"KARIM": {"name":"Karimnagar","state":"Telangana"},"SAHA": {"name":"Saharanpur","state":"Uttar Pradesh"},"SRIG": {"name":"Sri Ganganagar","state":"Rajasthan"},"NATH": {"name":"Natham","state":"Tamil Nadu"},"PIMP": {"name":"Pimpri","state":"Maharashtra"},"BHILAI": {"name":"Bhilai","state":"Chhattisgarh"},"BHUB": {"name":"Bhubaneshwar","state":"Orissa"},"UDGR": {"name":"Udgir","state":"Maharashtra"},"SIV": {"name":"Sivakasi","state":"Tamil Nadu"},"ANAN": {"name":"Anantapur","state":"Andhra Pradesh"},"SATA": {"name":"Satara","state":"Maharashtra"},"RAMP": {"name":"Ramayampet","state":"Telangana"},"VKBD": {"name":"Vikarabad","state":"Telangana"},"BHAR": {"name":"Bharuch","state":"Gujarat"},"RATL": {"name":"Ratlam","state":"Madhya Pradesh"},"MSS": {"name":"Mussoorie","state":"Uttarakhand"},"POCH": {"name":"Pochampally","state":"Telangana"},"AHD": {"name":"Ahmedabad","state":"Gujarat"},"JAGD": {"name":"Jagdalpur","state":"Chhattisgarh"},"JALG": {"name":"Jalgaon","state":"Maharashtra"},"NASK": {"name":"Nashik","state":"Maharashtra"},"KAIT": {"name":"Kaithal","state":"Haryana"},"MALE": {"name":"Malegaon","state":"Maharashtra"},"SING": {"name":"Singapore","state":"Singapore"},"YRLL": {"name":"Yellandu","state":"Telangana"},"TUMK": {"name":"Tumkur","state":"Karnataka"},"DHAN": {"name":"Dhanbad(Jharkhand)","state":"Jharkhand"},"AMB": {"name":"Ambala","state":"Haryana"},"ANKL": {"name":"Ankleshwar","state":"Gujarat"},"AGAR": {"name":"Agartala","state":"Tripura "},"PEN": {"name":"Pen","state":"Maharashtra"},"JODH": {"name":"Jodhpur","state":"Rajasthan"},"SPAN": {"name":"Spain","state":"Spain"},"GRKP": {"name":"Gorakhpur","state":"Uttar Pradesh"},"LAVA": {"name":"Lavasa","state":"Maharashtra"},"CHEN": {"name":"Chennai","state":"Tamil Nadu"},"DBBK": {"name":"Dubbaka","state":"Telangana"},"PALN": {"name":"Palanpur","state":"Gujarat"},"KAWA": {"name":"Kawardha","state":"Chhattisgarh"},"KATR": {"name":"Katra","state":"Jammu and Kashmir"},"THRM": {"name":"Thirumalagiri","state":"Telangana"},"VIET": {"name":"Vietnam","state":"Vietnam"},"BADD": {"name":"Baddi","state":"Himachal Pradesh"},"BELG": {"name":"Belgaum","state":"Karnataka"},"BANG": {"name":"Bengaluru","state":"Karnataka"},"DHLE": {"name":"Dhule","state":"Maharashtra"},"SMLA": {"name":"Shimla","state":"Himachal Pradesh"},"MARC": {"name":"Marcela","state":"Goa"},"NAVN": {"name":"Nawanshahr","state":"Punjab"},"PATI": {"name":"Patiala","state":"Punjab"},"IDKI": {"name":"Idukki","state":"Kerala"},"LAT": {"name":"Latur","state":"Maharashtra"},"JANG": {"name":"Jangareddy Gudem","state":"Andhra Pradesh"},"RUDP": {"name":"Rudrapur","state":"Uttarakhand"},"TAND": {"name":"Tandur","state":"Telangana"},"BAIJ": {"name":"Baijnath","state":"Himachal Pradesh"},"KUSH": {"name":"Kushinagar","state":"Uttar Pradesh"},"ZIRK": {"name":"Zirakpur","state":"Punjab"},"PLWA": {"name":"Palvancha","state":"Telangana"},"JNSI": {"name":"Jhansi","state":"Uttar Pradesh"},"LUCK": {"name":"Lucknow","state":"Uttar Pradesh"},"UJJN": {"name":"Ujjain","state":"Madhya Pradesh"},"BNGA": {"name":"Banga","state":"Punjab"},"NAIN": {"name":"Nainital","state":"Uttarakhand"},"OOTY": {"name":"Ooty","state":"Tamil Nadu"},"AMRI": {"name":"Amritsar","state":"Punjab"},"MOHL": {"name":"Mohali","state":"Punjab"},"SISA": {"name":"Sirsa","state":"Haryana"},"HRDA": {"name":"Harda","state":"Madhya Pradesh"},"ALBG": {"name":"Alibaug","state":"Maharashtra"},"BLGT": {"name":"Balaghat","state":"Madhya Pradesh"},"INDA": {"name":"Indapur","state":"Maharashtra"},"PATH": {"name":"Pathankot","state":"Punjab"},"POND": {"name":"Pondicherry","state":"Tamil Nadu"},"DHRA": {"name":"Dharuhera","state":"Haryana"},"JIND": {"name":"Jind","state":"Haryana"},"BLSR": {"name":"Balasore","state":"Orissa"},"MART": {"name":"Martur","state":"Andhra Pradesh"},"KOLH": {"name":"Kolhapur","state":"Maharashtra"},"MNGU": {"name":"Manuguru","state":"Telangana"},"DOGH": {"name":"Deoghar","state":"Jharkhand"},"KADI": {"name":"Kadi","state":"Gujarat"},"RANC": {"name":"Ranchi","state":"Jharkhand"},"ADIL": {"name":"Adilabad","state":"Telangana"},"CHAN": {"name":"Chandrapur","state":"Maharashtra"},"BIDR": {"name":"Bidar","state":"Karnataka"},"YAMU": {"name":"Yamunanagar","state":"Haryana"},"AHMG": {"name":"Ahmedgarh","state":"Punjab"},"BICH": {"name":"Biswanath Chariali","state":"Assam"},"ALLH": {"name":"Allahabad","state":"Uttar Pradesh"},"JUGH": {"name":"Junagadh","state":"Gujarat"},"BEAW": {"name":"Beawar","state":"Rajasthan"},"HISR": {"name":"Hisar","state":"Haryana"},"MYS": {"name":"Mysore","state":"Karnataka"},"JMDP": {"name":"Jamshedpur","state":"Jharkhand"},"MERT": {"name":"Meerut","state":"Uttar Pradesh"},"ARNI": {"name":"Arni","state":"Tamil Nadu"}}
    var insertAllCodes = redisClient.saddAsync("region:codes",regionCodes).then(console.log);

    var insertDetails = Promise.map(regionCodes,function(regionCode){
        return redisClient.setAsync("region:"+regionCode,JSON.stringify(regionWithDetails[regionCode]))
    });
    return Promise.join(insertAllCodes,insertDetails).then(function(){
        return regionWithDetails;
    });
};